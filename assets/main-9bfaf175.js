const n={log:(...o)=>console.log("[WA]",...o),err:(...o)=>console.error("[WA]",...o)},I="/@/ynov-1733302243/ynov_adventure/new-map",p=[{id:"#TPA-IA",label:"IA"},{id:"#TPAINFO",label:"Informatique"},{id:"#TPACYBER",label:"Cybersécurité"},{id:"#TPAARCHI",label:"Architecture"},{id:"#TPABIM",label:"Bâtiment Numérique"},{id:"#TPAAUDIO",label:"Audiovisuel"},{id:"#TPADIGITAL",label:"DIGITAL IA"},{id:"#TPA3D",label:"3D"},{id:"#TPAHUB",label:"Accueil"}],A=3;function h(o,e,t,l=!0){var a,s;const r=(a=WA.ui)==null?void 0:a.actionBar;if(!(r!=null&&r.addButton))return n.err("actionBar indisponible"),!1;try{(s=r.removeButton)==null||s.call(r,o)}catch{}try{const c={id:o,label:e,callback:t,clickCallback:t};return l&&(c.bgColor="#2ea7ff",c.isGradient=!0),r.addButton(c),!0}catch{try{return r.addButton({id:o,label:e,callback:t,clickCallback:t}),!0}catch(d){return n.err("addButton error:",d),!1}}}function g(o){var e,t,l;try{(l=(t=(e=WA.ui)==null?void 0:e.actionBar)==null?void 0:t.removeButton)==null||l.call(t,o)}catch{}}const y="teleport-btn";let f=!1,i=0,m=[];WA.onInit().then(()=>{var l,r;let o=0;const e=20,t=()=>{if(o++,h(y,"Téléportation",T,!0)){n.log("Bouton Téléportation OK");return}o<e?setTimeout(t,200):n.err("Impossible d’ajouter le bouton Téléportation (action bar).")};t();try{(r=(l=WA.ui).registerMenuCommand)==null||r.call(l,"Téléportation",T),p.forEach(a=>{var s,c;return(c=(s=WA.ui).registerMenuCommand)==null?void 0:c.call(s,a.label,()=>{try{WA.nav.goToRoom(I+a.id)}catch(d){n.err("goToRoom error:",d)}})})}catch{n.log("registerMenuCommand non disponible — pas bloquant.")}setTimeout(()=>{v()},5e3)}).catch(o=>n.err("onInit error:",o));function T(){f||(f=!0,g(y),i=0,b())}function B(){P(),f=!1,h(y,"Téléportation",T,!0)}function b(){P();const o=Math.max(1,Math.ceil(p.length/A));i=Math.max(0,Math.min(i,o-1));const e=i*A,t=p.slice(e,e+A);i>0&&u("tp-prev","◀",()=>{i--,b()}),t.forEach((l,r)=>u(`tp-${e+r}`,l.label,()=>{try{WA.nav.goToRoom(I+l.id)}catch(a){n.err("goToRoom error:",a)}B()})),i<o-1&&u("tp-next","▶",()=>{i++,b()}),u("tp-close","✖",B)}function u(o,e,t){h(o,e,t,!1)&&m.push(o)}function P(){m.forEach(o=>g(o)),m=[]}function v(){if(WA.player.state.hasVariable("ynov_adventure_form_done")){n.log("Form already done");return}n.log("Form opened"),WA.player.state.saveVariable("ynov_adventure_form_done",!1),WA.controls.disablePlayerControls(),WA.ui.modal.openModal({title:"Formulaire de présentation",allowApi:!0,position:"center",allow:null,src:"https://blocksurvey.io/xT1hdkDrQ7WQWPssxz04kA?v=o",allowFullScreen:!0,closable:!1},()=>{n.log("Form closed"),WA.controls.restorePlayerControls()})}
//# sourceMappingURL=main-9bfaf175.js.map
